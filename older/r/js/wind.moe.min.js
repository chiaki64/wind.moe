function ajaxSubmit(e,t){var a=getFormJson(e);$.ajax({url:e.action,type:e.method,data:a,success:t})}function getFormJson(e){var t={},a=$(e).serializeArray();return $.each(a,function(){void 0!==t[this.name]?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(this.value||"")):t[this.name]=this.value||""}),t}function getArticleJson(){var t=1;0==g_Article_Num&&$("#load_more").html(function(){var a='<p class="am-text-center" >-The End-</p>';return a}),$.getJSON("/api/more/"+g_Article_Num,function(e){$.each(e,function(e,a){console.log(a),g_Article_Num-=1,null!==a&&$("#add_more").html(function(e,t){var i='<div class="am-article">';i+=' <h3 class="am-article-title blog-title am-text-center am-animation-fade">',i+='<a href="/articles/',i+=a.id,i+='" style="">',i+=a.title,i+="</a></h3>",i+='<h4 class="am-article-meta blog-meta am-text-center" style="margin-top:-10px;color:#888;">',i+=a.published_at.toString(),i+=" under "+a.category,i+="</h4>",i+='<div  class="am-animation-fade">',i+=a.text.split("<!--more-->")[0],i+="</div>",i+='<p class="am-text-center"><a href="/articles/',i+=a.id,i+='" class="am-text-lg">-More-</a>',i+='<hr data-am-widget="divider" style="" class="am-divider am-divider-default" />',i+="</div>";var r=t+i;return r}),null===a&&1==t&&(t=0,window.console.log("到底了"),g_Article_Num=0,$("#load_more").html(function(){var a='<p class="am-text-center" >-The End-</p>';return a}))})})}function getCategoryJson(e){var a=1;$.getJSON("/api/category/"+e+"/"+g_Article_Num,function(t){$.each(t,function(t,i){console.log(i),g_Article_Num-=1,null!=i&&i.category===e&&$("#add_more").html(function(e,t){var a='<div class="am-article">';a+=' <h3 class="am-article-title blog-title am-text-center am-animation-fade">',a+='<a href="/articles/',a+=i.id,a+='" style="">',a+=i.title,a+="</a></h3>",a+='<h4 class="am-article-meta blog-meta am-text-center" style="margin-top:-10px;color:#888;">',a+=i.published_at.toString(),a+=" under "+i.category,a+="</h4>",a+='<div  class="am-animation-fade">',a+=i.text.split("<!--more-->")[0],a+="</div>",a+='<p class="am-text-center"><a href="/articles/',a+=i.id,a+='" class="am-text-lg">-More-</a>',a+='<hr data-am-widget="divider" style="" class="am-divider am-divider-default" />',a+="</div>";var r=t+a;return r}),(null===i&&1==a||1==g_Article_Num)&&(a=0,window.console.log("到底了"),g_Article_Num=0,$("#load_more").html(function(){var a='<p class="am-text-center" >-The End-</p>';return a}))})})}function wind_search(e){$.getJSON("./api/search/"+e,function(e){console.log(e),$.each(e,function(e,t){console.log(t),null!=t&&$("#add_more").html(function(e,a){var i='<div class="am-article">';i+=' <h3 class="am-article-title blog-title am-text-center am-animation-fade">',i+='<a href="/articles/',i+=t.id,i+='" style="">',i+=t.title,i+="</a></h3>",i+='<h4 class="am-article-meta blog-meta am-text-center" style="margin-top:-10px;color:#888;">',i+=t.published_at.toString(),i+=" under "+t.category,i+="</h4>",i+='<div class="am-animation-fade">',i+=t.text.split("<!--more-->")[0],i+="</div>",i+='<p class="am-text-center"><a href="/articles/',i+=t.id,i+='" class="am-text-lg">-More-</a>',i+='<hr data-am-widget="divider" style="" class="am-divider am-divider-default" />',i+="</div>";var r=a+i;return r})})})}function search_redirect(){var goto_url="https://wind.moe/search/"+eval(document.getElementById("keyword")).value;window.location.href=goto_url}function getRandomJson(){$.getJSON("https://wind.moe/api/random/article",function(e){$.each(e,function(e,t){console.log(t),null!==t&&$("#sidebar_random").html(function(e,a){var i='<div class="am-text-truncate" style="width:180px;"><a href="https://wind.moe/articles/';i+=t.id,i+='" class="am-link-muted am-text-truncate">',i+=t.title,i+="</a></div>";var r=a+i;return r})})})}function getBrowserInfo(){var e=navigator.userAgent.toLowerCase(),t=/msie [\d.]+;/gi,a=/firefox\/[\d.]+/gi,i=/chrome\/[\d.]+/gi,r=/safari\/[\d.]+/gi;return e.indexOf("msie")>0?e.match(t):e.indexOf("firefox")>0?e.match(a):e.indexOf("chrome")>0?e.match(i):e.indexOf("safari")>0&&e.indexOf("chrome")<0?e.match(r):void 0}var g_Article_Num=null,g_Article_Essay_Num=null,g_Article_Code_Num=null,g_Article_Daily_Num=null;if($(document).ready(function(){$.AMUI.progress.start(),$.getJSON("https://wind.moe/api/articles/max",function(e){g_Article_Num=e;var t=window.location.pathname;if(t.indexOf("essay")>0)getCategoryJson("essay");else if(t.indexOf("code")>0)getCategoryJson("code");else if(t.indexOf("daily")>0)getCategoryJson("daily");else if(t.indexOf("search")>0){var a=t.split("search/")[1];wind_search(a)}else t.indexOf("links")>0?$("#bread_del").remove():getArticleJson()})}),$(window).load(function(){if($.AMUI.progress.done(),getRandomJson(),document.getElementById("need_agent")){var e=getBrowserInfo(),t=(e+"").replace(/[^0-9.]/gi,""),a=String(e+t);document.getElementById("need_agent").value=a}window.console.log("Ծ‸Ծ 哎呀被发现了呢~\n如果您看到了这行文字，那么请收下我最诚挚的祝福  @稗田千秋 - Oct.17 2015")}),document.getElementById("editor"))var toolbar=["title","bold","italic","underline","strikethrough","color","|","ol","ul","blockquote","code","table","|","link","image","hr","|","indent","outdent","alignment"],editor=new Simditor({textarea:$("#editor"),toolbar:toolbar});$(document).ready(function(){$("#post-form").bind("submit",function(){return ajaxSubmit(this,function(){alert("success!"),parent.location.href="/articles"}),!1})});